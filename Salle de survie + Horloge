define SolarSensor 1076425094
define Memory -851746783
define Display 372043914 # à vérifier hash du petit Display
define Presence 322782515
define Lamp 1514476632
define SuitStore 318109626
define PressureRegulator 209854039
define Batterie 1406656973 # à vérifier
define Control -128473777
define Sleeper -1467449329 # à vérifier

Start:
#----- Si la batterie n'est plus à 100% activer le processus de consomation minimum
lb r0 Batterie PowerPotential Sum 
blt r0 7200 StartSave
#----- Horloge 24h -----
jal StartTimer

# Contrôle de l'éclairage en fct de la présence
StartLigth:
lb r1 Sleeper Open Sum
lb r0 Presence Quantity Sum
snez r0 r0 1
sb Lamp on r0

# Maintien les Combinaison toutes les 6h
lbn r0 Memory Timer Setting
beqal r0 0 StartSuitRestor
beqal r0 6 StartSuitRestor
beqal r0 12 StartSuitRestor
beqal r0 18 StartSuitRestor
lb r1 SuitStore RequiredPower max
blt r1 51 StopSuitRestor
j Start

#----- Fonctions -----
#----- Horloge 24h -----
# Placer le capteur solaire sur un Mur coté Sud Face au nord Alimentation vers le BAS
StartTimer:
lb r0 SolarSensor Horizontal Sum
add r0 r0 180 	# Angle de 0 à 359
mul r0 r0 4		# Nombre de minute dans 24h (360°)
move r1 r0		# Sauvegarde des minutes
div r0 r0 60	# Nombre d'heure
trunc r0 r0 	# Nombre d'heure sans Virgule
mul r15 r0 60	# Heure en minute à sous traire à minute totale
sub r1 r1 r15   # Minute sans les heures
div r1 100 		# Minute en 'décimale poour permettre un affichage 23.59
add r0 r0 r1	# Concaténation Heure & minute
sbn Display Timer Setting r0
sbn Memory Timer Setting r0 # Mémoire à mettre en liaison avec l'allimentation principale permettant d'afficher l'heure dans toute la base
StopTimer:
j ra

StartSuitRestor:
sb SuitStore On 1
lb r1 SuitStore RequiredPower max
blt r1 51 StopSuitRestor
sb PressureRegulator On 1
j ra

StopSuitRestor:
sb SuitStore On 0
sb PressureRegulator On 0
j ra

StartSave:
jal StopSuitRestor
sb Display On 0
sb Lamp On 0
sb Control On 0
